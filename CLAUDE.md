# 奇跡の一枚 — 要件定義書（最終／Flutter・審査通過優先MVP）

## 1. 概要
- **目的**：撮影または読み込んだ写真を、**生成AI**で自動補正し、**1〜10段階の「かっこよさ」**で強度調整してJPEG保存する。
- **対象OS/端末**：iOS（iPhone）**iOS 16+**、Flutter製。
- **価格**：完全無料（広告・課金なし）。
- **データ方針**：個人情報を収集しない／画像はサーバ保存しない／**EXIFは全削除**。

## 2. スコープ
- **インプット**：アプリ内カメラ撮影／フォトライブラリから単枚選択。
- **出力**：JPEG（入力解像度を基本維持、EXIF全削除）。
- **AI処理**：クラウド推論（生成AI）で“かっこよさ”補正。
- **UI**：ワンタップ基調＋**強度スライダー（1〜10）**。
- **結果保存**：端末の写真ライブラリのみ（共有機能はMVP外）。

## 3. ユーザーストーリー
1. アプリ起動 → 撮影 or 画像選択  
2. プレビューに**初期強度＝5**で自動適用  
3. スライダーで**1（原状維持）〜10（最大補正）**を調整  
4. 保存ボタンでJPEG保存（EXIFなし）→ 完了トースト表示

## 4. 機能要件

### 4.1 撮影・取り込み
- カメラ：オート撮影のみ、フロント／リア切替。
- ライブラリ：単枚インポート、HEIC/JPEG入力想定。

### 4.2 生成AI補正（かっこよさ）
- **パラメータ**：`strength = 1..10`
  - **1**：入力画像をそのまま（補正なし、EXIF削除のみ）
  - **2–4**：軽微な補正（コントラスト、彩度、色温度）
  - **5–7**：標準補正（明瞭化、スキントーン微調整、ノイズ低減）
  - **8–10**：最大補正（青系トーン寄せ・立体感強調）
- **出力一貫性**：自然さを損なわない範囲で補正。

### 4.3 保存
- フォトライブラリへJPEG保存（アルバム「奇跡の一枚」を自動作成）。
- **EXIF完全削除**（位置情報・日時・機種等すべて）。

### 4.4 エラーハンドリング
- ネットワーク不通：**リトライ導線**を提示。希望時は保存せず戻る。
- 大容量入力：内部で一時縮小→AI処理→保存。

## 5. 非機能要件
- **レイテンシ**：1枚あたり2〜4秒目標。
- **画質**：自然さ優先、アーティファクト抑制。
- **安定性**：クラッシュ率 < 1%。
- **オフライン**：不可（クラウド依存）。
- **セキュリティ**：TLS通信、サーバ保存なし。

## 6. API要件
- **エンドポイント**：`POST /v1/enhance`
- **入力**：JPEG/HEIC、`strength` (1–10)
- **出力**：JPEG（EXIFなし）
- **SLA目標**：P95 < 2.0s
- **サーバ側**：処理後即削除／ログ保存なし

## 7. プライバシー／審査配慮
- 広告識別子・追跡不使用（ATT不要）。
- 事前説明画面を実装：「画像は保存しません。EXIFは削除します。」
- `Info.plist` 例  
  - `NSCameraUsageDescription`：「撮影して加工するためにカメラを使用します。」  
  - `NSPhotoLibraryAddUsageDescription`：「加工した写真を保存するためにフォトライブラリを使用します。」
- ストア説明文：誇大表現を避け、シンプルに。

## 8. 画面要件
- **Home**：撮影／選択ボタン、強度初期値5表示
- **Editor**：プレビュー、スライダー1〜10、保存ボタン
- **完了トースト**：「保存しました」

## 9. 入出力形式
- **入力**：HEIC/JPEG
- **出力**：JPEG（品質95、EXIFなし）
- **色空間**：sRGB固定

## 10. 品質基準
- 強度1：入力と視覚的に同一
- 強度5：自然な明瞭化
- 強度10：最大補正、破綻なし
- 同条件で再現性一貫

## 11. テスト観点
- 端末：iPhone 12–15, iOS16–18
- 条件：逆光・夜景・ポートレート
- 機内モード時の挙動
- 保存画像のEXIFが空であること

## 12. 運用・ログ
- MVPでは分析・クラッシュ収集は実施しない
- サーバは処理のみ、ログ保存なし

## 13. 制約・前提
- クラウド依存で待ち時間あり
- 高解像度入力は縮小する場合あり
- 共有・バッチ処理は非対象

## 14. 将来拡張
- 共有先ショートカット
- 複数枚一括処理
- プリセット追加
- オフライン簡易フィルタ
